[install]
version=145.0.0
[[ "$INFILL_DEFAULT" = "osx" ]] && platform=darwin
[[ "$INFILL_DEFAULT" = "linux" ]] && platform=linux

if [[ "$platform" && ! -e $HOME/opt/google-cloud-sdk  ]]; then
  mkdir -p $HOME/opt
  curl https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-${version}-${platform}-x86_64.tar.gz | tar zx -C $HOME/opt
  $HOME/opt/google-cloud-sdk/install.sh --usage-reporting false --path-update false --command-completion false
fi

if [[ ! -e $HOME/bin/geco  ]]; then
  wget https://github.com/minimum2scp/geco/releases/download/2.0.5/geco_darwin_amd64.zip -O /tmp/geco_darwin_amd64.zip
  unzip -j /tmp/geco_darwin_amd64.zip -d $HOME/bin
fi

[update]
gcloud components update

wget https://github.com/minimum2scp/geco/releases/download/2.0.5/geco_darwin_amd64.zip -O /tmp/geco_darwin_amd64.zip
unzip -j /tmp/geco_darwin_amd64.zip -d $HOME/bin

[uninstall]
if [[ -e $HOME/opt/google-cloud-sdk ]]; then
  rm -rf $HOME/opt/google-cloud-sdk
fi

if [[ -e $HOME/bin/geco ]]; then
  rm -rf $HOME/bin/geco
fi
